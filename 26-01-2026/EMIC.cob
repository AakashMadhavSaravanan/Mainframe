IDENTIFICATION DIVISION.
PROGRAM-ID. AAKAHACK.

DATA DIVISION.
WORKING-STORAGE SECTION.

01 EMI-ACC-NO.
   05 EMI-ACC-NO-ARR OCCURS 5 TIMES PIC X(10).

01 EMI-AMOUNT.
   05 EMI-AMOUNT-ARR OCCURS 5 TIMES PIC 9(7).

01 ACC-NO.
   05 ACC-NO-ARR OCCURS 5 TIMES PIC X(10).

01 ACC-NAME.
   05 ACC-NAME-ARR OCCURS 5 TIMES PIC X(30).

01 ACC-TYPE.
   05 ACC-TYPE-ARR OCCURS 5 TIMES PIC X(1).

01 ACC-BAL.
   05 ACC-BAL-ARR OCCURS 5 TIMES PIC 9(7).

01 ACC-STATUS.
   05 ACC-STATUS-ARR OCCURS 5 TIMES PIC X(1).

01 I PIC 9 VALUE 1.
01 J PIC 9 VALUE 1.
01 WS-FOUND PIC X VALUE 'N'.

01 WS-PENALTY PIC 9(5) VALUE 250.
01 WS-TOTAL-RECORDS PIC 9(5) VALUE 0.
01 WS-SUCCESS PIC 9(5) VALUE 0.
01 WS-FAILED PIC 9(5) VALUE 0.
01 WS-TOTAL-EMI PIC 9(9) VALUE 0.
01 WS-TOTAL-PENALTY PIC 9(9) VALUE 0.

PROCEDURE DIVISION.

MAIN-SECTION.

*> EMI DATA
MOVE "ACC0000001" TO EMI-ACC-NO-ARR (1)
MOVE 1000 TO EMI-AMOUNT-ARR (1)

MOVE "ACC0000002" TO EMI-ACC-NO-ARR (2)
MOVE 2000 TO EMI-AMOUNT-ARR (2)

MOVE "ACC0000003" TO EMI-ACC-NO-ARR (3)
MOVE 5000 TO EMI-AMOUNT-ARR (3)

MOVE "ACC0000004" TO EMI-ACC-NO-ARR (4)
MOVE 1500 TO EMI-AMOUNT-ARR (4)

MOVE "ACC0000005" TO EMI-ACC-NO-ARR (5)
MOVE 3000 TO EMI-AMOUNT-ARR (5)

*> ACCOUNT DATA
MOVE "ACC0000001" TO ACC-NO-ARR (1)
MOVE "RAM" TO ACC-NAME-ARR (1)
MOVE "S" TO ACC-TYPE-ARR (1)
MOVE 10000 TO ACC-BAL-ARR (1)
MOVE "A" TO ACC-STATUS-ARR (1)

MOVE "ACC0000002" TO ACC-NO-ARR (2)
MOVE "SHYAM" TO ACC-NAME-ARR (2)
MOVE "S" TO ACC-TYPE-ARR (2)
MOVE 1000 TO ACC-BAL-ARR (2)
MOVE "A" TO ACC-STATUS-ARR (2)

MOVE "ACC0000003" TO ACC-NO-ARR (3)
MOVE "MOHAN" TO ACC-NAME-ARR (3)
MOVE "C" TO ACC-TYPE-ARR (3)
MOVE 7000 TO ACC-BAL-ARR (3)
MOVE "A" TO ACC-STATUS-ARR (3)

MOVE "ACC0000004" TO ACC-NO-ARR (4)
MOVE "RAVI" TO ACC-NAME-ARR (4)
MOVE "S" TO ACC-TYPE-ARR (4)
MOVE 1000 TO ACC-BAL-ARR (4)
MOVE "A" TO ACC-STATUS-ARR (4)

MOVE "ACC0000005" TO ACC-NO-ARR (5)
MOVE "KUMAR" TO ACC-NAME-ARR (5)
MOVE "S" TO ACC-TYPE-ARR (5)
MOVE 5000 TO ACC-BAL-ARR (5)
MOVE "I" TO ACC-STATUS-ARR (5)

*> PROCESS EMI
PERFORM VARYING I FROM 1 BY 1 UNTIL I > 5

   ADD 1 TO WS-TOTAL-RECORDS
   MOVE 'N' TO WS-FOUND

   PERFORM VARYING J FROM 1 BY 1 UNTIL J > 5

      IF EMI-ACC-NO-ARR (I) = ACC-NO-ARR (J)
         MOVE 'Y' TO WS-FOUND

         IF ACC-STATUS-ARR (J) NOT = 'A'
            ADD 1 TO WS-FAILED
         ELSE
            IF ACC-BAL-ARR (J) >= EMI-AMOUNT-ARR (I)
               SUBTRACT EMI-AMOUNT-ARR (I)
               FROM ACC-BAL-ARR (J)
               ADD EMI-AMOUNT-ARR (I)
               TO WS-TOTAL-EMI
               ADD 1 TO WS-SUCCESS
            ELSE
               SUBTRACT WS-PENALTY
               FROM ACC-BAL-ARR (J)
               ADD WS-PENALTY
               TO WS-TOTAL-PENALTY
               ADD 1 TO WS-FAILED
            END-IF
         END-IF

         EXIT PERFORM
      END-IF

   END-PERFORM

   IF WS-FOUND = 'N'
      ADD 1 TO WS-FAILED
   END-IF

END-PERFORM

DISPLAY "------------------------------------"
DISPLAY "Total EMI Records  : " WS-TOTAL-RECORDS
DISPLAY "Successful EMI     : " WS-SUCCESS
DISPLAY "Failed EMI         : " WS-FAILED
DISPLAY "Total EMI Collected: " WS-TOTAL-EMI
DISPLAY "Total Penalty      : " WS-TOTAL-PENALTY


STOP RUN.
